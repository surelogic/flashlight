<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<ad-hoc version='2.0'>
  <query id='Q0017' description='* What locks are held for each access of this non-static field? *' display='true'>SELECT O.THREADNAME &quot;Thread&quot;,A.TS &quot;Time&quot;,D.Lock &quot;Lock__|&quot;,LO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, LO.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, S.AtLine &quot;Line__(r)&quot;,D.ID &quot;LDID__(hide)&quot;,A.TRACE &quot;ATRACE__(hide)&quot;,L.TRACE &quot;LATRACE__(hide)&quot;
 FROM ACCESS A
 INNER JOIN OBJECT O ON
   O.Id = A.InThread 
 LEFT OUTER JOIN LOCKDURATION D ON
   D.InThread = A.InThread AND 
   (A.TS BETWEEN D.Start AND D.Stop)
 LEFT OUTER JOIN LOCK L ON
   L.Id = D.StartEvent
 LEFT OUTER JOIN TRACE TR ON
   TR.Id = L.TRACE
 LEFT OUTER JOIN SITE S ON
   S.Id = TR.SITE
 LEFT OUTER JOIN OBJECT LO ON
   LO.Id = S.InClass
WHERE 
   A.FIELD = ?FieldId? AND 
   A.RECEIVER = ?Receiver? 
ORDER BY O.THREADNAME ASC, A.TS ASC, D.Start DESC
</query>
  <query id='Q0023' description='* What locks are held for each access of this static field? *' display='true'>SELECT O.THREADNAME &quot;Thread&quot;,A.TS &quot;Time&quot;,D.Lock &quot;Lock__|&quot;,LO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, LO.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, S.AtLine &quot;Line__(r)&quot;,D.ID &quot;LDID__(hide)&quot;,A.TRACE &quot;ATRACE__(hide)&quot;,L.TRACE &quot;LATRACE__(hide)&quot;
 FROM ACCESS A
 INNER JOIN OBJECT O ON
   O.Id = A.InThread 
 LEFT OUTER JOIN LOCKDURATION D ON
   D.InThread = A.InThread AND 
   (A.TS BETWEEN D.Start AND D.Stop)
 LEFT OUTER JOIN LOCK L ON
   L.Id = D.StartEvent
 LEFT OUTER JOIN TRACE TR ON
   TR.Id = L.TRACE
 LEFT OUTER JOIN SITE S ON
   S.Id = TR.SITE
 LEFT OUTER JOIN OBJECT LO ON
   LO.Id = S.InClass
WHERE 
   A.FIELD = ?FieldId? AND 
   A.RECEIVER IS NULL
ORDER BY O.THREADNAME ASC, A.TS ASC, D.Start DESC</query>
  <query id='Q0010' description='A new query'>SELECT * FROM LOCKSHELD</query>
  <query id='Q0018' description='How often is a lock held when this instance field is accessed?' display='true'>SELECT LOCKS.*, CAST ((CAST (LOCKS.&quot;Lock Count&quot; AS FLOAT)) / (CAST (ACCESSES.ACCESSCOUNT AS FLOAT)) AS DECIMAL (4,3)) &quot;Frequency&quot;
FROM
(SELECT D.Lock &quot;Lock&quot;,RW.ID &quot;R/W Lock&quot;, COUNT(D.Lock) &quot;Lock Count&quot;
 FROM ACCESS A
      INNER JOIN LOCKDURATION D ON D.InThread = A.InThread AND D.Start &lt; A.TS AND D.Stop &gt; A.TS AND State = &apos;HOLDING&apos; 
      LEFT OUTER JOIN RWLOCK RW ON RW.ReadLock = D.LOCK OR RW.WRITELOCK = D.LOCK
    WHERE A.FIELD = ?FieldId? AND A.RECEIVER = ?Receiver?
 GROUP BY D.LOCK,RW.ID) AS LOCKS,
(SELECT COUNT(*) &quot;ACCESSCOUNT&quot; FROM ACCESS A WHERE A.FIELD = ?FieldId? AND A.RECEIVER = ?Receiver?) AS ACCESSES</query>
  <query id='Q0024' description='How often is a lock held when this static field is accessed?' display='true'>SELECT LOCKS.*, (CAST (LOCKS.LOCKCOUNT AS FLOAT)) / (CAST (ACCESSES.ACCESSCOUNT AS FLOAT))
FROM
(SELECT D.Lock &quot;LOCK&quot;,COUNT(D.Lock) &quot;LOCKCOUNT&quot;
 FROM ACCESS A
      INNER JOIN LOCKDURATION D ON D.InThread = A.InThread AND D.Start &lt; A.TS AND D.Stop &gt; A.TS AND State = &apos;HOLDING&apos; 
    WHERE A.FIELD = ?FieldId? AND A.RECEIVER IS NULL
 GROUP BY D.LOCK) AS LOCKS,
(SELECT COUNT(*) &quot;ACCESSCOUNT&quot; FROM ACCESS A WHERE A.FIELD = ?FieldId? AND A.RECEIVER IS NULL) AS ACCESSES</query>
  <query id='Q0029' description='Show details about this lock event' display='true'>select l.TS, t.ThreadName, l.Lock, lkType.ClassName as LockClass, 
l.LockIsThis as IsThis, l.LockIsClass as IsClass,
l.State, cl.PackageName, cl.ClassName, s.AtLine
from LOCK as l, TRACE tr, SITE s, OBJECT as cl, OBJECT as lk, OBJECT as t, OBJECT as lkType
where l.Id = ?LockEvent?
and tr.Id = l.Trace
and s.Id = tr.Site
and s.InClass = cl.Id
and l.Lock = lk.Id
and l.InThread = t.Id
and lk.Type = lkType.Id</query>
  <query id='Q0014' description='Show lock trace for a lock event' display='true'>SELECT D.Lock &quot;Lock__(r)&quot;, LO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, LO.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, S.AtLine &quot;Line__(r)&quot;, D.Start &quot;Time&quot;
FROM LOCK L
 INNER JOIN LOCKDURATION D ON
   D.InThread = L.InThread AND 
   L.TS &gt;= D.Start AND
   L.TS &lt; D.Stop
 INNER JOIN LOCK LL ON
   LL.Id = D.StartEvent
 INNER JOIN TRACE T ON
   T.ID = LL.TRACE
 INNER JOIN SITE S ON
   S.ID = T.SITE
 INNER JOIN OBJECT LO ON
   LO.ID = S.InClass
WHERE L.Id = ?LockEvent?
ORDER BY D.START DESC</query>
  <query id='Q0033' description='Show me all accesses of this non-static field' display='true'>SELECT &apos;?Package?&apos; &quot;Package__(&apos;package.gif&apos;)&quot;, &apos;?Class?&apos; &quot;Class__(&apos;class.gif&apos;)&quot;, &apos;?FieldName?&apos; &quot;FieldName__&quot;, 
       O.THREADNAME &quot;Thread__|&quot;, A.TS &quot;Time&quot;, A.ID &quot;AID__(hide)&quot;, A.TRACE &quot;ATRACE__(hide)&quot;
 FROM ACCESS A
 INNER JOIN OBJECT O ON
   O.Id = A.InThread 
WHERE 
   A.FIELD = ?FieldId? AND 
   A.RECEIVER = ?Receiver?
ORDER BY A.TS ASC</query>
  <query id='Q0031' description='Show me all accesses of this static field' display='true'>SELECT &apos;?Package?&apos; &quot;Package__(&apos;package.gif&apos;)&quot;, &apos;?Class?&apos; &quot;Class__(&apos;class.gif&apos;)&quot;, &apos;?FieldName?&apos; &quot;FieldName__&quot;, 
       O.THREADNAME &quot;Thread__|&quot;, A.TS &quot;Time&quot;, A.ID &quot;AID__(hide)&quot;, A.TRACE &quot;ATRACE__(hide)&quot;
 FROM ACCESS A
 INNER JOIN OBJECT O ON
   O.Id = A.InThread 
WHERE 
   A.FIELD = ?FieldId? AND 
   A.RECEIVER IS NULL
ORDER BY A.TS ASC</query>
  <query id='Q0028' description='Show stack trace for a field access' display='true'>SELECT s.PACKAGENAME &quot;Package__(&apos;package.gif&apos;)&quot;, s.CLASSNAME &quot;Class__(&apos;class.gif&apos;)&quot;, s.INFILE &quot;File&quot;, s.LOCATION &quot;Location&quot;, s.ATLINE &quot;Line__(r)&quot;
FROM TABLE (STACKTRACE(?ATRACE?)) s
</query>
  <query id='Q0027' description='Show stack trace for a lock acquisition' display='true'>SELECT s.PACKAGENAME &quot;Package__(&apos;package.gif&apos;)&quot;, s.CLASSNAME &quot;Class__(&apos;class.gif&apos;)&quot;, s.INFILE &quot;File&quot;, s.LOCATION &quot;Location&quot;, s.ATLINE &quot;Line__(r_)&quot;
FROM TABLE (STACKTRACE(?LATRACE?)) s
</query>
  <query id='Q0013' description='Show stack trace for a lock event' display='true'>SELECT s.PACKAGENAME &quot;Package__(&apos;package.gif&apos;)&quot;, s.CLASSNAME &quot;Class__(&apos;class.gif&apos;)&quot;, s.INFILE &quot;File&quot;, s.LOCATION &quot;Location&quot;, s.ATLINE &quot;Line__(r_)&quot;
FROM TABLE (STACKTRACE(?LETRACE?)) s</query>
  <query id='Q0030' description='Show Tables'>select st.TABLENAME &quot;Table&quot;,sco.columnname &quot;COLUMN__|&quot;,sco.columndatatype,sco.autoincrementvalue,sco.autoincrementstart,sco.autoincrementinc
   from sys.sysschemas sc,sys.systables st,sys.syscolumns sco 
   where sc.schemaname = &apos;FLASHLIGHT&apos; and st.schemaid = sc.schemaid and sco.referenceid = st.tableid 
   order by st.tablename,sco.columnnumber</query>
  <query id='Q0012' description='Show the lock events for a lock graph edge' display='true'>select lo.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, lo.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, s.AtLine &quot;Line__]&quot;, tho.ThreadName &quot;Thread__|&quot;, lh.LockEvent &quot;LockEvent__(r)&quot;
from LOCKSHELD as lh, LOCK l, TRACE tr, SITE s, OBJECT lo, OBJECT tho
where lh.LockHeld=?LockHeld?
  and lh.LockAcquired=?LockAcquired?
  and lh.LockEvent=l.Id
  and tr.Id = l.Trace
  and s.Id = tr.Site
  and lo.Id = s.InClass
  and tho.Id = l.InThread
order by lo.PackageName,lo.ClassName, s.AtLine, tho.ThreadName, lh.LockEvent
  </query>
  <query id='Q0005' description='What locks are contended for the longest time?' display='true' display-at-root='true'>select Lock &quot;Lock__(c)&quot;, (trim (cast(sum(Duration) as char(20)))) || &apos; ns&apos; as &quot;Block Time__(r)&quot;
from LOCKDURATION    
where State = &apos;BLOCKING&apos;
group by Lock
order by sum(duration) desc
  </query>
  <query id='Q0034' description='What locks are held during this field access?' display='true'>SELECT O.THREADNAME &quot;Thread&quot;, A.TS &quot;Time&quot;, D.Lock &quot;Lock__|&quot;, LO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, LO.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, S.AtLine &quot;Line__(r)&quot;, D.ID &quot;LDID__(hide)&quot;, A.TRACE &quot;ATRACE__(hide)&quot;,L.TRACE &quot;LATRACE__(hide)&quot;
 FROM ACCESS A
 INNER JOIN OBJECT O ON
   O.Id = A.InThread 
 INNER JOIN LOCKDURATION D ON
   D.InThread = A.InThread AND 
   (A.TS BETWEEN D.Start AND D.Stop)
 LEFT OUTER JOIN LOCK L ON
   L.Id = D.StartEvent
 LEFT OUTER JOIN TRACE TR ON
   TR.Id = L.TRACE
 LEFT OUTER JOIN SITE S ON
   S.Id = TR.SITE
 LEFT OUTER JOIN OBJECT LO ON
   LO.Id = S.InClass
WHERE 
   A.ID = ?AID?
ORDER BY O.THREADNAME ASC, A.TS ASC, D.Start DESC
</query>
  <query id='Q0011' description='What locks could potentially cause deadlock?' display='true' display-at-root='true'>select Component &quot;Component&quot;, LockHeld &quot;LockHeld__(r)|&quot;,
  LockAcquired &quot;LockAcquired__(r)&quot;,
  Count &quot;Count__(r)&quot;, FirstTime &quot;FirstTime&quot;, LastTime &quot;LastTime&quot;
from lockcycle
where count &gt; 1
order by count desc</query>
  <query id='Q0002' description='What non-static fields are shared?' display='true' display-at-root='true'>select
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  F.FieldName &quot;FieldName__]&quot;,
  FI.Receiver &quot;Receiver&quot;,
  THO.ThreadName &quot;Thread__|&quot;,
  FI.ReadUCCount + FI.ReadCount &quot;Reads__(sum on 3,4)(r)&quot;,
  FI.WriteUCCount + FI.WriteCount &quot;Writes__(sum on 3,4)(r)&quot;,
  FI.ReadUCCount &quot;Reads During Construction__(sum on 3,4)(r)&quot;,
  FI.WriteUCCount &quot;Writes During Construction__(sum on 3,4)(r)&quot;,
  F.ID &quot;FieldId__(hide)&quot;
from OBJECT O,
     FIELD F,
     FIELDINSTANCETHREAD FI,
     OBJECT THO
where
  F.DeclaringType = O.Id
  and FI.FIELD = F.ID 
  and THO.ID = FI.Thread
order by O.PackageName,O.ClassName,F.FieldName,FI.Receiver,THO.ThreadName</query>
  <query id='Q0015' description='What non-static fields have a lock set?' display='true' display-at-root='true'>SELECT 
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  FI.FieldName &quot;FieldName__]&quot;,
  I.RECEIVER &quot;Receiver&quot;, F.LOCK &quot;Lock__|&quot;, I.FIELD &quot;FieldId__(hide)&quot;
 FROM OBJECT O
 INNER JOIN FIELD FI ON FI.DeclaringType = O.Id
 INNER JOIN INTERESTINGFIELD I ON FI.STATIC = &apos;N&apos; AND I.FIELD=FI.ID
 INNER JOIN FIELDINSTANCELOCKSET F ON F.FIELD = I.FIELD AND F.RECEIVER = I.RECEIVER 
 ORDER BY O.PackageName,O.ClassName,FI.FieldName,I.Receiver</query>
  <query id='Q0016' description='What non-static fields have an empty lock set?' display='true' display-at-root='true'>SELECT 
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  FI.FieldName &quot;FieldName__]&quot;,
  I.RECEIVER &quot;Receiver__|&quot;,I.FIELD &quot;FieldId__(hide)&quot;
 FROM OBJECT O
 INNER JOIN FIELD FI ON FI.DeclaringType = O.Id
 INNER JOIN INTERESTINGFIELD I ON FI.STATIC = &apos;N&apos; AND I.FIELD=FI.ID
 LEFT OUTER JOIN FIELDINSTANCELOCKSET F ON F.FIELD = I.FIELD AND F.RECEIVER = I.RECEIVER 
 WHERE F.LOCK IS NULL
 ORDER BY O.PackageName, O.ClassName, FI.FieldName</query>
  <query id='Q0003' description='What objects are threads?' display='true'>select t.Id, t.ThreadName, cl.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
       cl.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;
from OBJECT as t, OBJECT as cl   
where t.ThreadName is not null
  and t.Type=cl.Id</query>
  <query id='Q0001' description='What static fields are shared?' display='true' display-at-root='true'>select
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  F.FieldName &quot;FieldName__]&quot;,
  THO.ThreadName &quot;Thread__|&quot;,
  FS.ReadCount &quot;Read Count__(sum on 3)(r)&quot;,
  FS.WriteCount &quot;Write Count__(sum on 3)(r)&quot;,
  F.ID &quot;FieldId__(hide)&quot;
from OBJECT O,
     FIELD F,
     FIELDSTATICTHREAD FS,
     OBJECT THO
where
  F.DeclaringType = O.Id
  and FS.FIELD = F.ID 
  and THO.ID = FS.Thread
order by O.PackageName,O.ClassName,F.FieldName,THO.ThreadName</query>
  <query id='Q0021' description='What static fields have a lock set?' display='true' display-at-root='true'>SELECT 
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  FI.FieldName &quot;FieldName&quot;,
  F.LOCK &quot;Lock__|&quot;,
  I.FIELD &quot;FieldId__(hide)&quot; 
 FROM OBJECT O
 INNER JOIN FIELD FI ON FI.DeclaringType = O.Id
 INNER JOIN INTERESTINGFIELD I ON I.RECEIVER IS NULL AND I.FIELD=FI.ID
 INNER JOIN FIELDLOCKSET F ON F.FIELD = I.FIELD
 ORDER BY O.PackageName,O.ClassName,FI.FieldName</query>
  <query id='Q0022' description='What static fields have an empty lock set?' display='true' display-at-root='true'>SELECT 
  O.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  O.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;,
  FI.FieldName &quot;FieldName__|&quot;,
  I.FIELD &quot;FieldId__(hide)&quot;
 FROM OBJECT O
 INNER JOIN FIELD FI ON FI.DeclaringType = O.Id
 INNER JOIN INTERESTINGFIELD I ON I.RECEIVER IS NULL AND I.FIELD=FI.ID
 LEFT OUTER JOIN FIELDLOCKSET F ON F.FIELD = I.FIELD
 WHERE F.LOCK IS NULL
 ORDER BY O.PackageName,O.ClassName,FI.FieldName</query>
  <query id='Q0025' description='What threads read and write a static field?' display='true'>SELECT
  CO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  CO.ClassName   &quot;Class__(&apos;class.gif&apos;)&quot;,
  F.FieldName    &quot;FieldName&quot;,
  THO.ThreadName &quot;Thread__|&quot;,
  FI.ReadCount &quot;Reads__(sum on 3)&quot;,
  FI.WriteCount &quot;Writes__(sum on 3)&quot;
 FROM FIELDSTATICTHREAD FI, OBJECT THO, FIELD F, OBJECT CO
 WHERE FI.FIELD = ?FieldId? AND 
   THO.ID = FI.THREAD AND 
   F.ID = FI.FIELD AND
   CO.ID = F.DECLARINGTYPE</query>
  <query id='Q0019' description='What threads read and write this non-static field?' display='true'>SELECT
  CO.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;,
  CO.ClassName   &quot;Class__(&apos;class.gif&apos;)&quot;,
  F.FieldName    &quot;FieldName&quot;,
  THO.ThreadName &quot;Thread__|&quot;,
  FI.ReadUCCount + FI.ReadCount &quot;Reads__(sum on 3)&quot;,
  FI.WriteUCCount + FI.WriteCount &quot;Writes__(sum on 3)&quot;,
  FI.ReadUCCount &quot;Reads During Construction__(sum on 3)&quot;,
  FI.WriteUCCount &quot;Writes During Construction__(sum on 3)&quot;
 FROM FIELDINSTANCETHREAD FI, OBJECT THO, FIELD F, OBJECT CO
 WHERE FI.FIELD = ?FieldId? AND 
   FI.RECEIVER = ?Receiver? AND 
   THO.ID = FI.THREAD AND 
   F.ID = FI.FIELD AND
   CO.ID = F.DECLARINGTYPE</query>
  <query id='Q0004' description='What threads use each lock?' display='true'>select 
  L.LOCK &quot;Lock&quot;, 
  O.THREADNAME &quot;Thread Name__|&quot;,
  count(*) &quot;Acquisition Count&quot;
from LOCK L, OBJECT O
where L.INTHREAD = O.ID
  and L.STATE = &apos;AFTER ACQUISITION&apos;
group by l.lock, O.THREADNAME
order by 1, 2
</query>
  <query id='Q0007' description='When and where is this thread contending for that lock?' display='true'>select ld.StartEvent as LockEvent,
   ld.Start,ld.Duration 
from LOCKDURATION AS ld, LOCK as le
where ld.State = &apos;BLOCKING&apos;
  and ld.Lock=?Lock?
  and ld.InThread=?InThread?
  and le.Id=ld.StartEvent
  and le.InClass=?InClass?
  and le.AtLine=?AtLine?
order by ld.Duration desc
  </query>
  <query id='Q0009' description='Where does a thread hold a lock and acquire another?' display='true' display-at-root='true'>select lh.LockEvent &quot;LockEvent__(hide)&quot;, count(LockHeld) &quot;Number of Locks Already Held&quot;,
  tho.ThreadName &quot;ThreadName&quot;, lo.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, lo.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, s.AtLine &quot;Line__(r)&quot;, le.trace &quot;LETRACE__(hide)&quot;
from LOCKSHELD lh, LOCK le, TRACE tr, SITE s, OBJECT lo, OBJECT tho
where lh.LockEvent = le.Id
  and tr.Id = le.Trace
  and s.Id = tr.Site
  and lo.Id = s.InClass
  and tho.Id = le.InThread
group by lh.LockEvent, lo.ClassName, lo.PackageName, s.AtLine, tho.ThreadName, le.trace
order by 2 desc, 1

</query>
  <query id='Q0006' description='Which threads and what code are contending for a lock?' display='true'>select lo.PackageName &quot;Package__(&apos;package.gif&apos;)&quot;, lo.ClassName &quot;Class__(&apos;class.gif&apos;)&quot;, s.AtLine &quot;Line__]&quot;,
  tho.ThreadName &quot;Thread__|&quot;, ld.id &quot;LDID__(hide)&quot;,(trim(cast(sum(ld.Duration) as char(10))) || &apos; ns&apos;) &quot;BlockTime__(sum &apos; ns&apos;)(r)&quot;, le.trace &quot;LATRACE__(hide)&quot;
from LOCKDURATION ld, LOCK le, TRACE tr, SITE s, OBJECT lo, OBJECT tho
where ld.Lock=?Lock?
  and ld.State = &apos;BLOCKING&apos;
  and le.Id=ld.StartEvent
  and tr.Id = le.Trace
  and s.Id = tr.Site
  and lo.Id = s.InClass
  and tho.Id = ld.InThread
group by lo.PackageName,lo.ClassName, s.AtLine, tho.ThreadName, ld.Id, ld.State, le.trace
order by lo.PackageName, lo.ClassName, s.AtLine, sum(ld.Duration) desc
  </query>
  <query id='Q0008' description='Who is interacting with that lock at that moment?' display='true'>select ld.InThread &quot;InThread&quot;, ld.State &quot;State&quot;, ld.Start &quot;Start&quot;, ld.Stop &quot;Stop&quot;, ld.Duration &quot;Duration&quot;, 
  ld.StartEvent &quot;LockEvent&quot;
from LOCK as le, LOCKDURATION AS ld
where le.Id=?LockEvent?
  and ld.Lock=?Lock?
  and le.ts between ld.Start and ld.Stop
order by ld.Start 
  </query>
  <sub-query id='Q0017' sub-query='Q0027'/>
  <sub-query id='Q0017' sub-query='Q0028'/>
  <sub-query id='Q0023' sub-query='Q0027'/>
  <sub-query id='Q0023' sub-query='Q0028'/>
  <sub-query id='Q0033' sub-query='Q0034'/>
  <sub-query id='Q0033' sub-query='Q0028'/>
  <sub-query id='Q0031' sub-query='Q0034'/>
  <sub-query id='Q0031' sub-query='Q0028'/>
  <sub-query id='Q0012' sub-query='Q0029'/>
  <sub-query id='Q0012' sub-query='Q0013'/>
  <sub-query id='Q0012' sub-query='Q0014'/>
  <sub-query id='Q0005' sub-query='Q0006'/>
  <sub-query id='Q0034' sub-query='Q0027'/>
  <sub-query id='Q0034' sub-query='Q0028'/>
  <sub-query id='Q0011' sub-query='Q0012'/>
  <sub-query id='Q0002' sub-query='Q0033'/>
  <sub-query id='Q0002' sub-query='Q0017'/>
  <sub-query id='Q0002' sub-query='Q0019'/>
  <sub-query id='Q0002' sub-query='Q0018'/>
  <sub-query id='Q0015' sub-query='Q0033'/>
  <sub-query id='Q0015' sub-query='Q0017'/>
  <sub-query id='Q0015' sub-query='Q0019'/>
  <sub-query id='Q0015' sub-query='Q0018'/>
  <sub-query id='Q0016' sub-query='Q0033'/>
  <sub-query id='Q0016' sub-query='Q0017'/>
  <sub-query id='Q0016' sub-query='Q0019'/>
  <sub-query id='Q0016' sub-query='Q0018'/>
  <sub-query id='Q0001' sub-query='Q0023'/>
  <sub-query id='Q0001' sub-query='Q0031'/>
  <sub-query id='Q0001' sub-query='Q0025'/>
  <sub-query id='Q0001' sub-query='Q0024'/>
  <sub-query id='Q0021' sub-query='Q0023'/>
  <sub-query id='Q0021' sub-query='Q0031'/>
  <sub-query id='Q0021' sub-query='Q0025'/>
  <sub-query id='Q0021' sub-query='Q0024'/>
  <sub-query id='Q0022' sub-query='Q0023'/>
  <sub-query id='Q0022' sub-query='Q0031'/>
  <sub-query id='Q0022' sub-query='Q0025'/>
  <sub-query id='Q0022' sub-query='Q0024'/>
  <sub-query id='Q0009' sub-query='Q0013'/>
  <sub-query id='Q0009' sub-query='Q0014'/>
  <sub-query id='Q0006' sub-query='Q0027'/>
</ad-hoc>
