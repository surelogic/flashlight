<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>

   <!-- UI for initializing and setting Flashlight preferences -->
	<extension point="org.eclipse.ui.preferencePages">
		<page
			class="com.surelogic.flashlight.client.eclipse.preferences.FlashlightPreferencePage"
			id="com.surelogic.flashlight.client.eclipse.preferences.FlashlightPreferencePage"
			name="Flashlight" />
	</extension>
	<extension point="org.eclipse.core.runtime.preferences">
		<initializer
			class="com.surelogic.flashlight.client.eclipse.preferences.PreferenceInitializer" />
	</extension>
   
   	<!-- Flashlight menus -->
	<extension point="org.eclipse.ui.actionSets">
		<actionSet label="Flashlight ActionSet" visible="true"
			id="com.surelogic.flashlight.client.eclipse.workbenchActionSet">
			<menu id="com.surelogic.flashlight.client.eclipse.workbenchMenu"
				label="Flashlight" path="additions">
				<groupMarker name="client" />
				<separator name="additions" />
			</menu>
			<action
				class="com.surelogic.flashlight.client.eclipse.actions.ShowFlashlightPerspectiveAction"
				id="com.surelogic.flashlight.client.eclipse.actions.ShowFlashlightPerspectiveAction"
				icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_logo.gif"
				label="Open Flashlight Perspective" menubarPath="com.surelogic.flashlight.client.eclipse.workbenchMenu/client"
				helpContextId="menu-open-flashlight-perspective">
			</action>
		</actionSet>
	</extension>
	
	<!-- Flashlight perspective links and Java perspective links -->
	<extension point="org.eclipse.ui.perspectives">
		<perspective name="Flashlight"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_logo.gif"
			class="com.surelogic.flashlight.client.eclipse.perspectives.FlashlightPerspectiveFactory"
			id="com.surelogic.flashlight.client.eclipse.perspectives.FlashlightPerspectiveFactory">
		</perspective>
	</extension>
   
   <!-- Define a new mode for running applications -->
	<extension point="org.eclipse.debug.core.launchModes">
		<launchMode label="%fl.run" launchAsLabel="%fl.runAs.label"
			mode="flashlight" />
	</extension>
	<!--
		Define a special launch delegate for Flashlight that handles local
		Java applications in our new mode
	-->
	<extension point="org.eclipse.debug.core.launchDelegates">
		<launchDelegate
			delegate="com.surelogic.flashlight.client.eclipse.launch.FlashlightLaunchConfigurationDelegate"
			id="com.surelogic.flashlight.client.eclipse.launch.FlashlightLaunchConfigurationDelegate"
			modes="flashlight" type="org.eclipse.jdt.launching.localJavaApplication" />
	</extension>
   
   <!-- We need a launch group (the id string is in the actions code) -->
	<extension point="org.eclipse.debug.ui.launchGroups">
		<launchGroup bannerImage="/lib/images/fl_wiz.png"
			id="com.surelogic.flashlight.launchGroup.flashlight"
			image="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_run.gif"
			label="Flashlight" mode="flashlight" title="%fl.launchGroup.title" />
	</extension>

   <!-- UI for launching Java applications in Flashlight -->
	<extension point="org.eclipse.ui.actionSets">
		<actionSet label="%fl.launchActionSet.label" visible="true"
			id="com.surelogic.flashlight.launchActionSet">
			<action label="%fl.run" style="pulldown"
				icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_run.gif"
				class="com.surelogic.flashlight.client.eclipse.actions.RunToolbarAction"
				menubarPath="org.eclipse.ui.run/ExternalToolsGroup" id="com.surelogic.flashlight.FlashlightMenuDelegateMenu">
			</action>
			<action id="com.surelogic.flashlight.actions.RunToolbarAction"
				toolbarPath="org.eclipse.debug.ui.launchActionSet/debug"
				hoverIcon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_run.gif"
				class="com.surelogic.flashlight.client.eclipse.actions.RunToolbarAction"
				icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_run.gif"
				helpContextId="run_action_context" label="%fl.runDropDownAction.label"
				style="pulldown">
			</action>
		</actionSet>
	</extension>
   
   <!-- I have to add a tab group for my mode...I just use jdt's class -->
	<extension point="org.eclipse.debug.ui.launchConfigurationTabGroups">
		<launchConfigurationTabGroup
			type="org.eclipse.jdt.launching.localJavaApplication"
			helpContextId="org.eclipse.jdt.debug.ui.launchConfigHelpContext.local_java_application"
			class="org.eclipse.jdt.internal.debug.ui.launcher.LocalJavaApplicationTabGroup"
			id="com.surelogic.flashlight.launchConfigurationTabGroup.localJavaApplication">
			<launchMode mode="flashlight"
				description="%fl.localJavaApplicationTabGroupDescription">
			</launchMode>
		</launchConfigurationTabGroup>
	</extension>
	<!--
		Causes the "Flashlight as" menus to work properly (launch shortcut
		actions)
	-->
	<extension point="org.eclipse.debug.ui.launchShortcuts">
		<shortcut label="%fl.javaApplicationShortcut.label"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_app.gif"
			helpContextId="org.eclipse.jdt.debug.ui.shortcut_local_java_application"
			modes="flashlight"
			class="org.eclipse.jdt.internal.debug.ui.launcher.JavaApplicationLaunchShortcut"
			id="com.surelogic.flashlight.localJavaShortcut">
			<contextualLaunch>
				<enablement>
					<with variable="selection">
						<count value="1" />
						<iterate>
							<or>
								<test property="org.eclipse.jdt.launching.hasMain" />
								<and>
									<test property="org.eclipse.jdt.launching.isContainer" />
									<test property="org.eclipse.jdt.launching.hasProjectNature"
										args="org.eclipse.jdt.core.javanature" />
								</and>
							</or>
						</iterate>
					</with>
				</enablement>
			</contextualLaunch>
		</shortcut>
	</extension>
	<extension point="org.eclipse.ui.views">
		<category name="Flashlight" id="com.surelogic.flashlight.Flashlight">
		</category>
   
      <!-- UI for raw data -->
		<view allowMultiple="false" category="com.surelogic.flashlight.Flashlight"
			class="com.surelogic.flashlight.client.eclipse.views.run.RunView"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_run_view.gif"
			id="com.surelogic.flashlight.client.eclipse.views.run.RunView" name="Flashlight Runs">
		</view>
   
      <!-- UI for entering ad hoc queries -->
		<view allowMultiple="false" category="com.surelogic.flashlight.Flashlight"
			class="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryEditorView"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/query.gif"
			id="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryEditorView"
			name="Flashlight Query Editor">
		</view>
		<view allowMultiple="false" category="com.surelogic.flashlight.Flashlight"
			class="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryMenuView"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/fl_logo.gif"
			id="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryMenuView"
			name="Query Flashlight">
		</view>
		<view allowMultiple="false" category="com.surelogic.flashlight.Flashlight"
			class="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryResultsView"
			icon="platform:/plugin/com.surelogic.common/src/com/surelogic/common/images/drum.gif"
			id="com.surelogic.flashlight.client.eclipse.views.adhoc.QueryResultsView"
			name="Flashlight Query Results">
		</view>
	</extension>
</plugin>